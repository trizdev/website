(()=>{"use strict";var t={n:e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return t.d(r,{a:r}),r},d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};const e=wp;var r=t.n(e);function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(a=o.key,i=void 0,i=function(t,e){if("object"!==n(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(a,"string"),"symbol"===n(i)?i:String(i)),o)}var a,i}const a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,n;return e=t,n=[{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"general";Array.isArray(t)||(t=[t]);var r=window["_wds_"+e]||{};return t.forEach((function(t){r=r&&r.hasOwnProperty(t)?r[t]:""})),r}},{key:"get_bool",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"general";return!!this.get(t,e)}}],(r=null)&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,a=void 0,a=function(t,e){if("object"!==i(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===i(a)?a:String(a)),n)}var o,a}const c=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.authors={},this.taxonomy_terms={},this.register_api_fetch_middleware()}var e,n,o;return e=t,n=[{key:"key",value:function(t,e){return t+(e=""+e).trim()}},{key:"add_categories",value:function(t){this.add_taxonomy_terms("category",t)}},{key:"get_categories",value:function(t){return this.get_taxonomy_terms("category",t)}},{key:"add_tags",value:function(t){this.add_taxonomy_terms("post_tag",t),this.add_taxonomy_terms("post_tag",t,"name")}},{key:"get_tags",value:function(t){return this.get_taxonomy_terms("post_tag",t)}},{key:"author_key",value:function(t){return this.key("author-",t)}},{key:"add_authors",value:function(t){var e=this;Array.isArray(t)?t.forEach((function(t){e.add_author(t)})):t.id&&this.add_author(t)}},{key:"add_author",value:function(t){var e=this.author_key(t.id);this.authors[e]=t}},{key:"get_author",value:function(t){var e=this.author_key(t);return!!this.authors.hasOwnProperty(e)&&this.authors[e]}},{key:"get_query_var",value:function(t,e){for(var r=t.substring(1).split(/[&?]/),n=0;n<r.length;n++){var o=r[n].split("=");if(decodeURIComponent(o[0])===e)return decodeURIComponent(o[1])}return!1}},{key:"register_api_fetch_middleware",value:function(){var t=this;r().apiFetch.use((function(e,r){if(t.is_term_request(e)){var n=t.get_query_var(e.path,"_fields");n&&(e.path=e.path.replace(encodeURIComponent(n),encodeURIComponent(n+",description")))}var o=r(e);return o.then((function(r){t.is_category_request(e)&&t.add_categories(r),t.is_tag_request(e)&&t.add_tags(r),t.is_get_request(e,"/wp/v2/users/")&&t.add_authors(r);var n=t.get_taxonomy_slug(e);n&&t.add_taxonomy_terms(n,r)})).catch((function(t){console.log(t)})),o}))}},{key:"get_taxonomy_slug",value:function(t){if(t.method&&"GET"!==t.method||!t.path)return!1;var e=this.get_taxonomies(),r=t.path.match(/\/wp\/v2\/([a-z_-]*).*/);return!(!r||r.length<2||!r[1])&&!!e.includes(r[1])&&r[1]}},{key:"is_term_request",value:function(t){return this.is_category_request(t)||this.is_tag_request(t)||!!this.get_taxonomy_slug(t)}},{key:"is_category_request",value:function(t){return this.is_get_request(t,"/wp/v2/categories")}},{key:"is_tag_request",value:function(t){return this.is_get_request(t,"/wp/v2/tags")}},{key:"is_get_request",value:function(t,e){return t&&(!t.method||"GET"===t.method)&&t.path&&t.path.includes(e)}},{key:"taxonomy_key",value:function(t,e){return this.key("taxonomy-"+t+"-term-",e)}},{key:"get_taxonomy_terms",value:function(t,e){var r=this,n=[];return e.forEach((function(e){var o=r.taxonomy_key(t,e);r.taxonomy_terms.hasOwnProperty(o)&&n.push(r.taxonomy_terms[o])})),n.length!==e.length?[]:n}},{key:"add_taxonomy_terms",value:function(t,e){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id";Array.isArray(e)?e.forEach((function(e){r.add_taxonomy_term(t,e,n)})):e.id&&this.add_taxonomy_term(t,e,n)}},{key:"add_taxonomy_term",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id",n=this.taxonomy_key(t,e[r]);this.taxonomy_terms[n]=e}},{key:"get_taxonomies",value:function(){return a.get("taxonomies","replacement")}}],n&&u(e.prototype,n),o&&u(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}(),s=jQuery;var l=t.n(s);function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function m(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,a=void 0,a=function(t,e){if("object"!==f(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===f(a)?a:String(a)),n)}var o,a}var y=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cache=e,this.category_promise=null,this.tag_promise=null,this.author_promise=null,this.term_promise={}}var e,n,o;return e=t,(n=[{key:"fetch_category_data",value:function(t){var e=this;return this.category_promise||(this.category_promise=new Promise((function(n,o){if(t&&t.length){var a=e.cache.get_categories(t);if(a.length)n(a);else{var i="/wp/v2/categories?"+l().param({include:t});r().apiFetch({path:i}).then((function(t){n(t)})).catch(o)}}else n([])})),this.category_promise.then((function(){e.category_promise=null}))),this.category_promise}},{key:"fetch_tag_data",value:function(t){var e=this;return this.tag_promise||(this.tag_promise=new Promise((function(n,o){if(t&&t.length){var a={};if(e.ids_numeric(t))a.include=t;else{if(!e.ids_slugs(t))return void o("IDs malformed");a.slug=t}var i=e.cache.get_tags(t);if(i.length)n(i);else{var u="/wp/v2/tags?"+l().param(a);r().apiFetch({path:u}).then((function(t){n(t)})).catch(o)}}else n([])})),this.tag_promise.then((function(){e.tag_promise=null}))),this.tag_promise}},{key:"fetch_taxonomy_terms",value:function(t,e){var n=this;return this.term_promise.hasOwnProperty(t)||(this.term_promise[t]=new Promise((function(o,a){if(e&&e.length){var i=n.cache.get_taxonomy_terms(t,e);if(i.length)o(i);else{var u=l().param({include:e}),c="/wp/v2/"+t+"?"+u;r().apiFetch({path:c}).then((function(t){o(t)})).catch(a)}}else o([])})),this.term_promise[t].then((function(){delete n.term_promise[t]}))),this.term_promise[t]}},{key:"fetch_author_data",value:function(t){var e=this;return this.author_promise||(this.author_promise=new Promise((function(n,o){if(t){var a=e.cache.get_author(t);if(a)n(a);else{var i="/wp/v2/users/"+t;r().apiFetch({path:i}).then((function(t){n(t)})).catch(o)}}else n(!1)})),this.author_promise.then((function(){e.author_promise=null}))),this.author_promise}},{key:"ids_numeric",value:function(t){return!!Array.isArray(t)&&t.reduce((function(t,e){var r=!isNaN(e);return t&&r}),!0)}},{key:"ids_slugs",value:function(t){return!!Array.isArray(t)&&t.reduce((function(t,e){var r=isNaN(e);return t&&r}),!0)}}])&&m(e.prototype,n),o&&m(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();const h=y,g=_;var p=t.n(g);function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function d(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,a=void 0,a=function(t,e){if("object"!==v(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==v(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===v(a)?a:String(a)),n)}var o,a}const b=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,n;return e=t,n=[{key:"truncate_string",value:function(t,e){return t.length>e&&(t=Array.from(t).splice(0,e-4).join("").trim()+" ..."),t}},{key:"normalize_whitespace",value:function(t){return(t=(t=t.replace(/(\r\n|\n|\r|\t)/gm," ")).replace(/ +/g," ")).trim()}},{key:"remove_shortcodes",value:function(t){if(-1===(t=t||"").indexOf("["))return t;var e=this;return t.replace(/\[(\[?)([a-zA-Z0-9_-]*)(?![\w-])([^\]\/]*(?:\/(?!])[^\]\/]*)*?)(?:(\/)]|](?:([^\[]*(?:\[(?!\/\2])[^\[]*)*)\[\/\2])?)(]?)/g,(function(t,r,n,o,i,u,c,s,l){if(arguments.length<7)return t||"";if("["===r&&"]"===c)return t.substring(1,t.length-1);var f=a.get("omitted_shortcodes","replacement");return u&&!f.includes(n)?e.remove_shortcodes(u.trim()):""}))}},{key:"strip_html",value:function(t){t=(t=t.toString()).replace(/(<([^>]+)>)/gi,"");var e=document.createElement("DIV");return e.innerHTML=t,e.textContent||e.innerText||""}},{key:"process_string",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e=t.strip_html(e),e=t.normalize_whitespace(e),r&&(e=t.truncate_string(e,r)),e}}],(r=null)&&d(e.prototype,r),n&&d(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function w(t){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w(t)}function k(t){return function(t){if(Array.isArray(t))return x(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return x(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return x(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function S(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,a=void 0,a=function(t,e){if("object"!==w(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==w(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===w(a)?a:String(a)),n)}var o,a}var P=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.fetcher=e}var e,n,o;return e=t,n=[{key:"format_date",value:function(t,e){return r().date.dateI18n(e,t)}},{key:"get_excerpt_or_trimmed_content",value:function(t){return this.get_trimmed_excerpt(t.get_excerpt(),t.get_content())}},{key:"get_trimmed_excerpt",value:function(t,e){var r=t||e,n=a.get("metadesc_max_length","replacement");r=b.strip_html(r);var o=(r=b.normalize_whitespace(r)).indexOf("[");return-1!==o&&o<n&&(r=b.remove_shortcodes(r)),this.truncate_meta_description(r,n)}},{key:"truncate_meta_description",value:function(t,e){return b.truncate_string(t,e)}},{key:"replace_term_macros",value:function(t,e){var r={"%%id%%":e.get_id(),"%%term_title%%":e.get_title(),"%%term_description%%":e.get_description()};return"category"===e.get_taxonomy()?(r["%%category%%"]=e.get_title(),r["%%category_description%%"]=e.get_description()):"post_tag"===e.get_taxonomy()&&(r["%%tag%%"]=e.get_title(),r["%%tag_description%%"]=e.get_description()),this.do_replace(t,{},r)}},{key:"replace",value:function(t,e){var r=this,n=this.fetcher,o={"%%name%%":function(){return new Promise((function(t,r){n.fetch_author_data(e.get_author_id()).then((function(e){var r=e&&e.name?e.name:"";t({"%%name%%":r})})).catch(r)}))},"%%category%%":function(t){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"name",a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise((function(i,u){n.fetch_category_data(e.get_category_ids()).then((function(e){var n=r.get_term_macro_value(e,o,a),u={};t&&t.length&&(u[t[0]]=n),i(u)})).catch(u)}))},"%%tag%%":function(t){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"name",a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise((function(i,u){n.fetch_tag_data(e.get_tag_ids()).then((function(e){var n=r.get_term_macro_value(e,o,a),u={};t&&t.length&&(u[t[0]]=n),i(u)})).catch(u)}))},"%%ct_(desc_){0,1}([a-z_-]*)%%":function(t){var a="name";3===t.length&&"desc_"===t[1]&&(a="description");var i=t[2];return"category"===i?(0,o["%%category%%"])(t,a,!0):"post_tag"===i?(0,o["%%tag%%"])(t,a,!0):new Promise((function(o,u){n.fetch_taxonomy_terms(i,e.get_taxonomy_terms(i)).then((function(e){var n=r.get_term_macro_value(e,a,!0),i={};t&&t.length&&(i[t[0]]=n),o(i)})).catch(u)}))}};return this.do_replace(t,o,{"%%id%%":e.get_id(),"%%title%%":e.get_title(),"%%excerpt%%":this.get_excerpt_or_trimmed_content(e),"%%excerpt_only%%":e.get_excerpt(),"%%modified%%":this.format_date(e.get_modified(),"Y-m-d H:i:s"),"%%date%%":this.format_date(e.get_date(),this.get_date_format()),"%%userid%%":e.get_author_id(),"%%caption%%":e.get_excerpt()})}},{key:"do_replace",value:function(t,e,r){var n=this,o=[];return Object.keys(e).forEach((function(r){var n=e[r],a=k(t.matchAll(r));a&&a.length&&a.forEach((function(t){t&&t.length&&o.push(n(t))}))})),new Promise((function(e,a){Promise.all(o).then((function(o){o.push(r),o.push(n.get_general_replacements());var a=o.reduce((function(t,e){return Object.assign(t,e)}),{});Object.keys(a).forEach((function(e){var r=new RegExp(e,"g");t=t.replace(r,a[e])}));var i=new RegExp("%%[a-zA-Z_]*%%","g");t=t.replace(i,""),e(t)})).catch(a)}))}},{key:"get_term_macro_value",value:function(t,e,r){Array.isArray(t)||(t=[]);var n=(t=p().sortBy(t,(function(t){return t.name}))).reduce((function(t,r){return r.hasOwnProperty(e)&&t.push(r[e]),t}),[]);return r&&n.length?n[0]:n.join(", ")}},{key:"get_general_replacements",value:function(){var t=a.get("time_format","replacement");return{"%%sep%%":this.get_global("sep"),"%%sitename%%":this.get_global("sitename"),"%%sitedesc%%":this.get_global("sitedesc"),"%%page%%":this.get_global("page"),"%%pagetotal%%":this.get_global("pagetotal"),"%%pagenumber%%":this.get_global("pagenumber"),"%%spell_pagenumber%%":this.get_global("spell_pagenumber"),"%%spell_pagetotal%%":this.get_global("spell_pagetotal"),"%%spell_page%%":this.get_global("spell_page"),"%%currenttime%%":this.format_date(new Date,t),"%%currentdate%%":this.format_date(new Date,this.get_date_format()),"%%currentmonth%%":this.format_date(new Date,"F"),"%%currentyear%%":this.format_date(new Date,"Y")}}},{key:"get_date_format",value:function(){return a.get("date_format","replacement")}},{key:"get_global",value:function(t){return a.get(["replacements",t],"replacement")}}],n&&S(e.prototype,n),o&&S(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();const j=P;var O,A;jQuery,O=new c,A=new h(O),window.Wds.macroReplacement=new j(A)})();